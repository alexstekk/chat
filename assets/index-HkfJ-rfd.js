(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();let L=[{id:"1",avatar:"./img/avatars/1.jpg",firstname:"Ольга",lastname:"Токсикова",city:"Днепропетровск"},{id:"2",avatar:"./img/avatars/2.jpg",firstname:"Айбелив",lastname:"Айкенфлаева",city:"Москва"}],d=[{id:"1",userId:"1",time:"вчера в 17.45",message:'Где взять на прокат вечернее красивое платье? А еще лучше дизайнерское! Предстоит участие в <a href="#">мероприятии</a>, где все гости будут наверняка одеты в наряды "от кутюр", а у меня со средствами туговато, да и жалко на один раз такие деньжищи отваливать. Мне бы салон найти, где на прокат можно такой наряд взять. Поделитесь, пожалуйста, советами.'},{id:"2",userId:"2",time:"вчера в 18.45",message:"Поисковик вам в помощь! Но цена примерно в половину стоимости платья."},{id:"3",userId:"1",time:"сегодня в 17.45",message:'Где взять на прокат вечернее красивое платье? А еще лучше дизайнерское! Предстоит участие в мероприятии, где все гости будут наверняка одеты в наряды "от кутюр", а у меня со средствами туговато'},{id:"4",userId:"2",time:"сегодня в 18.45",message:"Поисковик вам в помощь! Но цена примерно в половину стоимости платья."}];const y="2",E="messages";document.getElementById("app");const c=document.getElementById("chat"),u=document.getElementById("send-message-btn"),f=document.getElementById("form"),m=document.getElementById("message-text"),g=document.getElementById("open-chat"),p=document.getElementById("close-chat-btn"),a=document.getElementById("messages-list"),M=document.getElementById("username"),T=document.getElementById("user-city");document.addEventListener("DOMContentLoaded",S);f==null||f.addEventListener("submit",O);g==null||g.addEventListener("click",x);p==null||p.addEventListener("click",A);document.addEventListener("keydown",B);m==null||m.addEventListener("keyup",w);function S(){b(),D(),h(d),v()}function O(e){e.preventDefault();const t=e.target.message.value.trim()??"";t&&(_(t),f.reset())}function b(){const e=I(y);e&&(M.innerHTML=`${e.firstname} ${e.lastname}`,T.innerText=e.city)}function B(e){}function _(e){u.disabled=!0,u.innerText="Отправляем...",d=[{id:Math.floor(Math.random()*100),userId:y,time:new Intl.DateTimeFormat("ru",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}).format(Date.now()),message:e},...d],setTimeout(()=>{N(d),h(d),v(),F(a==null?void 0:a.lastElementChild,"painted",2e3),u.disabled=!1,u.innerText="Отправить"},1500)}function w(e){e.target.value.split(/\r|\r\n|\n/).length>=4?m.rows=7:m.rows=4}function v(){var e;(e=a==null?void 0:a.lastElementChild)==null||e.scrollIntoView({behavior:"smooth"})}function A(){c==null||c.classList.add("hidden")}function x(){c==null||c.classList.remove("hidden")}function h(e){a.innerHTML="",e==null||e.forEach(t=>C(t))}function C(e){const t=l("div",["message"]),i=l("div",["message__avatar","avatar"]),o=l("img"),n=l("div",["message__text"]),s=l("div",["message__time"]),r=I(e.userId);o.src=(r==null?void 0:r.avatar)||"",o.alt=(r==null?void 0:r.firstname)||"",n.innerHTML=e.message||"",s.innerText=e.time||"",y===r.id&&t.classList.add("my"),i.prepend(o),t.append(i),t.append(n),t.append(s),a==null||a.prepend(t)}function l(e,t){const i=document.createElement(e);return t&&i.classList.add(...t),i}function I(e){return L.find(t=>t.id===e)}function D(){const e=localStorage.getItem(E);e&&(d=JSON.parse(e))}function N(e){localStorage.setItem(E,JSON.stringify(e))}function F(e,t="",i=300){e.classList.add(t),setTimeout(()=>{e.classList.remove(t)},i)}
