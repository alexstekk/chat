(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();let M=[{id:"1",avatar:"./img/avatars/1.jpg",firstname:"Ольга",lastname:"Токсикова",city:"Днепропетровск"},{id:"2",avatar:"./img/avatars/2.jpg",firstname:"Айбелив",lastname:"Айкенфлаева",city:"Москва"}],d=[{id:"1",userId:"1",time:"вчера в 17.45",message:'Где взять на прокат вечернее красивое платье? А еще лучше дизайнерское! Предстоит участие в <a href="#">мероприятии</a>, где все гости будут наверняка одеты в наряды "от кутюр", а у меня со средствами туговато, да и жалко на один раз такие деньжищи отваливать. Мне бы салон найти, где на прокат можно такой наряд взять. Поделитесь, пожалуйста, советами.'},{id:"2",userId:"2",time:"вчера в 18.45",message:"Поисковик вам в помощь! Но цена примерно в половину стоимости платья."},{id:"3",userId:"1",time:"сегодня в 17.45",message:'Где взять на прокат вечернее красивое платье? А еще лучше дизайнерское! Предстоит участие в мероприятии, где все гости будут наверняка одеты в наряды "от кутюр", а у меня со средствами туговато'},{id:"4",userId:"2",time:"сегодня в 18.45",message:"Поисковик вам в помощь! Но цена примерно в половину стоимости платья."}];const y="2",E="messages";document.getElementById("app");const c=document.getElementById("chat"),f=document.getElementById("send-message-btn"),m=document.getElementById("form"),u=document.getElementById("message-text"),g=document.getElementById("open-chat"),p=document.getElementById("close-chat-btn"),i=document.getElementById("messages-list"),S=document.getElementById("username"),T=document.getElementById("user-city");document==null||document.addEventListener("DOMContentLoaded",O);m==null||m.addEventListener("submit",b);g==null||g.addEventListener("click",x);p==null||p.addEventListener("click",A);document.addEventListener("keydown",_);u==null||u.addEventListener("keyup",w);function O(){B(),D(),I(d),h()}function b(e){e.preventDefault();const t=e.target.message.value.trim()??"";t&&(v(t),m.reset())}function B(){const e=L(y);e&&(S.innerHTML=`${e.firstname} ${e.lastname}`,T.innerText=e.city)}function _(e){if(e.key==="Enter"){const t=m.message.value.trim()??"";t&&(v(t),m.reset())}}function v(e){f.disabled=!0,f.innerText="Отправляем...",d=[{id:Math.floor(Math.random()*100),userId:y,time:new Intl.DateTimeFormat("ru",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}).format(Date.now()),message:e},...d],setTimeout(()=>{F(d),I(d),h(),N(i==null?void 0:i.lastElementChild,"painted",2e3),f.disabled=!1},1500)}function w(e){e.target.value.split(/\r|\r\n|\n/).length>=4?u.rows=7:u.rows=4}function h(){var e;(e=i==null?void 0:i.lastElementChild)==null||e.scrollIntoView({behavior:"smooth"})}function A(){c==null||c.classList.add("hidden")}function x(){c==null||c.classList.remove("hidden")}function I(e){i.innerHTML="",e.forEach(t=>C(t))}function C(e){const t=l("div",["message"]),r=l("div",["message__avatar","avatar"]),o=l("img"),n=l("div",["message__text"]),s=l("div",["message__time"]),a=L(e.userId);o.src=(a==null?void 0:a.avatar)||"",o.alt=(a==null?void 0:a.firstname)||"",n.innerHTML=e.message||"",s.innerText=e.time||"",y===a.id&&t.classList.add("my"),r.prepend(o),t.append(r),t.append(n),t.append(s),i==null||i.prepend(t)}function l(e,t){const r=document.createElement(e);return t&&r.classList.add(...t),r}function L(e){return M.find(t=>t.id===e)}function D(){const e=localStorage.getItem(E);e&&(d=JSON.parse(e))}function F(e){localStorage.setItem(E,JSON.stringify(e))}function N(e,t="",r=300){e.classList.add(t),setTimeout(()=>{e.classList.remove(t)},r)}
